<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Title</title>
    <link rel="stylesheet" href="animate.css">
    <link href='http://cdn.webfont.youziku.com/webfonts/nomal/23205/445/5a7973c1f629d9159cbfdbcc.css' rel='stylesheet'
          type='text/css'/>
    <style>
        .text-scroll_wrapper {
            display: none;
            background-color: #000;
            _background-color: #eee;
            background-color: #eee \0;
            padding: 10px;
            background: rgba(0, 0, 0, 0.1);
            filter: progid:DXImageTransform.Microsoft.gradient(startcolorstr=#20000000, endcolorstr=#20000000);
            left: 50% !important;
            margin-left: -511px !important;
            z-index: 999999;
        }

        .text-scroll_wrapper .close {
            background-image: url(201701221147037.png);
            background-repeat: no-repeat;
            position: absolute;
            right: 10px;
            top: 10px;
            cursor: pointer;
            height: 20px;
            width: 20px;
        }

        .text-scroll {
            position: relative;
            width: 1002px;
            height: 660px;
            background: url(bg2018.jpg) no-repeat;
            overflow: hidden;
        }

        .text-scroll_bd {
            position: absolute;
            /*top: 110px;*/
            top: 660px;
            left: 50%;
            width: 700px;
            height: 390px;
            color: #aa1a1a;
            padding: 10px 40px 40px;
            margin-left: -390px;
            background-color: rgba(225, 225, 225, .8);
            overflow: hidden;
        }

        .text-scroll_title {
            font-family: 'RS_XingKai100f9572d25aa5';
            text-align: center;
        }

        .text-scroll_box {
            height: 290px;
            overflow: hidden;
        }

        .text-scroll_box p {
            line-height: 2.5em;
            font-weight: bolder;
            margin-top: 0;
            margin-bottom: 0;
        }

        .text-scroll_box .text-scroll_content p {
            text-indent: 2em;
        }

        .text-scroll_box .text-scroll_footer {
            margin: 50px 0 290px;
        }

        .text-scroll_box .text-scroll_footer p {
            text-align: right;
        }

        .text-scroll_banner {
            position: absolute;
            width: 500px;
            height: 200px;
            bottom: 50%;
            left: 50%;
            margin-bottom: -100px;
            margin-left: -250px;
            background: url("banner.png") no-repeat;
            background-size: 100% 100%;
            z-index: 3;

        }
    </style>
</head>
<body>
<div class="text-scroll_wrapper">
    <div class="text-scroll">
        <a class="close" href="javascript:;"></a>
        <embed id="embedPlayer" src="9680.mp3" autostart="true" loop="true" hidden="true" height="0"/>

        <div class="text-scroll_banner"></div>

        <div class="text-scroll_bd">
            <h1 class="text-scroll_title">致全省工商系统信息化战线的同仁们新年快乐</h1>
            <div id="jsTextScroll" class="text-scroll_box">
                <div class="text-scroll_content">
                    <p>
                        新年的钟声即将敲响，我们与2017年作别，迎来2018年的第一缕阳光。在这辞旧迎新的时刻，谨向你们及家属致以新年的祝福！
                    </p>
                    <p>
                        有付出，就会有收获。过去的2017年，全省工商系统干部职工付出了很多，也收获了很多。这一年，全省工商系统深化改革、体制调整、巡视整改、履职尽责点题督查等多重任务叠加，工作异常繁重。全省工商人焕发干事创业热情和克难攻坚决心，各项工作取得显著成效。这一年，我们用汗水和智慧，顺利完成工商体制调整，商事制度改革持续深化，事中事后监管创新突破，工商履职服务全面优化，按期落实“五证合一”“两证整合”改革任务，全程电子化、“全国一张网”、信息共享交换平台等多项试点率先突破。这一年，我们深化点题督查消费维权，放心消费保护有力加强，干部队伍建设全面提速。一年的努力，为“十三五”的良好开局、为工商事业更好发展积累了更好位势。我们倍感欣慰和自豪！
                    </p>
                    <p>
                        “天时人事日相催，冬至阳生春又来”。成绩不会从天而降，改革发展催人奋进。2017年又是具有特别意义的重要一年，我们即将迎接党的十九大和省党代会胜利召开。2017年，也是我们全省工商部门深化“放管服”改革，助推供给侧结构性改革大有可为的一年。我们要深刻领会党的十八届六中全会精神，按照省委、省政府决策部署，认真贯彻落实中央经济工作会议和省委全会暨全省经济工作会议精神，瞄准“两个一流”目标，扭住“四个抓手”，持续深化商事制度改革，创新事中事后监管，不断加强消费维权，激发大众创业、万众创新活力，促进经济平稳健康发展和社会和谐稳定，为湖北建成支点、走在前列勇立新功、再创佳绩。
                    </p>
                    <p>
                        祝全省工商干部职工及家属新年快乐，阖家幸福，万事如意！
                    </p>
                </div>
                <div class="text-scroll_footer">
                    <p class="name">湖北省工商行政管理局</p>
                    <p class="time">2016年12月30日</p>
                </div>
            </div>
        </div>
    </div>
</div>

<script src="https://cdn.bootcss.com/jquery/1.11.3/jquery.min.js"></script>
<script src="https://cdn.bootcss.com/jquery-tools/1.2.7/jquery.tools.min.js"></script>
<script>
    $(document).ready(function () {
        $(".text-scroll_wrapper").overlay({
            closeOnClick: false,
            speed: 'fast',
            top: '5%',
            mask: {
                color: '#000',
                closeSpeed: 200,
                opacity: 0.1
            },
            load: true
        });

        $(".text-scroll_wrapper").click(function () {
            //停止播放音乐
            try {
                $("#embedPlayer")[0].stop();
            } catch (err) {
                console.error(err);
            }

            //移除dom
            $(".text-scroll_wrapper").remove();
        });

        $(".text-scroll_banner").animate({
            "width": "620px",
            "height": "260px",
            "margin-bottom": "-130px",
            "margin-left": "-310px"
        }, 1000, function () {
            $(this).animate({
                "width": "310px",
                "height": "130px",
                "bottom": "18px",
                "left": "5px",
                "margin-bottom": "0",
                "margin-left": "0",
            }, 2000, function () {
                $(".text-scroll_bd").animate({
                    "top": "110px"
                }, 1000);
            });
        });

        /**
         * @desc 文字滚动效果
         * @param {number} lineHieght - 文字一次向上滚动的距离或高度；
         * @param {number} speed - 滚动速度；
         * @param {number} delay - 滚动停顿的时间间隔；
         * @param {number} elementTop - 文字内容顶端与滚动区域顶端的距离，初始值为0；
         * @param {object} element - 文档对象；
         * startmarquee(25, 30, 3000, 0, element);//带停顿效果
         * startmarquee(25, 40, 0, 0, element);//不间断连续
         */
        function startMarquee(lineHieght, speed, delay, elementTop, element) {//传递参数
            var hander,
                flag = false;
            element.innerHTML += element.innerHTML; //对象中的实际内容被复制了一份，包含了两个ul，当然li标签也由原来的3行，变为6行；复制的目的在于给文字不间断向上滚动提供过渡。

            /* element.onmouseover = function () {
                 flag = true;
             }//鼠标滑过，停止滚动；

             element.onmouseout = function () {
                 flag = false;
             }//鼠标离开，开始滚动；flag是true还是false直接影响到下面start()函数的执行；*/

            element.scrollTop = elementTop;//文字内容顶端与滚动区域顶端的距离，初始值为0；

            function start() {
                hander = setInterval(scrolling, speed); //每隔一段时间，setInterval便会执行一次scrolling函数；speed越大，滚动时间间隔越大，滚动速度越慢；
                if (!flag) {
                    element.scrollTop += 1;
                }//滚动停止或开始，取决于flag传来的布尔值；
            }

            function scrolling() {
                if (element.scrollTop % lineHieght != 0) {//如果不被整除，即一次上移的高度达不到lineHieght，则内容会继续往上滚动；
                    element.scrollTop += 1;
                    if (element.scrollTop >= element.scrollHeight / 2) element.scrollTop = 0;//对象o中的内容之前被复制了一次，所以它的滚动高度，其实是原来内容的两倍高度；当内容向上滚动到scrollHeight / 2的高度时，全部3行文字已经显示了一遍，至此整块内容scrollTop归0；再等待下一轮的滚动，从而达到文字不间断向上滚动的效果；
                } else {
                    clearInterval(hander);//否则清除hander，暂停滚动
                    setTimeout(start, delay);//经过delay间隔后，启动start()再连续滚动
                }
            }

            setTimeout(start, delay);//第一次启动滚动；setTimeout会在一定的时间后执行函数start()，且只执行一次
        }

        startMarquee(40, 40, 0, 850, document.getElementById("jsTextScroll"));

        //定时关闭
        setTimeout(function () {
            //停止播放音乐
            try {
                $("#embedPlayer")[0].stop();
            } catch (err) {
                console.error(err);
            }

            //移除dom
            $(".text-scroll_wrapper").remove();
            //关闭弹层
            $(".text-scroll_wrapper .close").click();
        }, 55000);
    });
</script>
</body>
</html>